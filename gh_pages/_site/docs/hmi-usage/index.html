<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <title>HMI NuGet Package Usage | Event Video Playback</title>
  <meta name="description" content="Integrate video playback controls into your TwinCAT HMI and WPF applications">

  <link rel="stylesheet" href="/EventVideoPlayback/assets/css/style.css">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HMI NuGet Package Usage | Event Video Playback</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="HMI NuGet Package Usage" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Integrate video playback controls into your TwinCAT HMI and WPF applications" />
<meta property="og:description" content="Integrate video playback controls into your TwinCAT HMI and WPF applications" />
<link rel="canonical" href="http://localhost:4000/EventVideoPlayback/docs/hmi-usage/" />
<meta property="og:url" content="http://localhost:4000/EventVideoPlayback/docs/hmi-usage/" />
<meta property="og:site_name" content="Event Video Playback" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-11-11T07:46:24-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HMI NuGet Package Usage" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-11-11T07:46:24-08:00","datePublished":"2025-11-11T07:46:24-08:00","description":"Integrate video playback controls into your TwinCAT HMI and WPF applications","headline":"HMI NuGet Package Usage","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/EventVideoPlayback/docs/hmi-usage/"},"url":"http://localhost:4000/EventVideoPlayback/docs/hmi-usage/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="header-content">
      <a class="site-title" href="/EventVideoPlayback/">
        Event Video Playback
      </a>
      <nav class="site-nav">
        <button class="mobile-menu-toggle" aria-label="Toggle menu">‚ò∞</button>
        <a href="/EventVideoPlayback/">Home</a>
        <a href="/EventVideoPlayback/docs/getting-started/">Getting Started</a>
        <a href="/EventVideoPlayback/docs/plc-usage/">PLC Library</a>
        <a href="/EventVideoPlayback/docs/service-config/">Service Config</a>
        <a href="/EventVideoPlayback/docs/hmi-usage/">HMI Usage</a>
        <a href="https://github.com/Beckhoff-USA-Community/EventVideoPlayback" target="_blank" class="btn btn-ghost" style="margin-left: 1rem;">GitHub</a>
      </nav>
    </div>
  </div>
</header>


  <main class="main-content">
    <div class="section doc-section" style="background-color: #f8f8f8; min-height: calc(100vh - 70px);">
  <div class="container">
    <!-- Mobile TOC Toggle -->
    <button class="doc-toc-mobile-toggle" id="mobile-toc-toggle">
      <span>üìë Table of Contents</span>
    </button>

    <div class="doc-layout">
      <!-- Table of Contents Sidebar -->
      <aside class="doc-sidebar" id="doc-sidebar">
        <nav class="doc-toc">
  <div class="doc-toc-header">
    <h3>On This Page</h3>
  </div>
  <ul class="doc-toc-list" id="doc-toc-list">
    <!-- JavaScript will populate this -->
  </ul>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const content = document.querySelector('.doc-content');
  const tocList = document.getElementById('doc-toc-list');

  if (!content || !tocList) return;

  // Get only H2 headings
  const headings = content.querySelectorAll('h2');

  if (headings.length === 0) {
    // Hide TOC if no H2 headings found
    const tocNav = document.querySelector('.doc-toc');
    if (tocNav) {
      tocNav.style.display = 'none';
    }
    return;
  }

  headings.forEach((heading, index) => {
    // Create an ID if it doesn't exist
    if (!heading.id) {
      heading.id = 'heading-' + index;
    }

    // Create list item
    const li = document.createElement('li');

    // Create link
    const a = document.createElement('a');
    a.href = '#' + heading.id;
    a.textContent = heading.textContent;
    a.className = 'toc-link';

    li.appendChild(a);
    tocList.appendChild(li);
  });

  // Highlight current section on scroll
  const observerOptions = {
    rootMargin: '-100px 0px -66%',
    threshold: 0
  };

  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      const id = entry.target.id;
      const tocLink = document.querySelector(`.toc-link[href="#${id}"]`);

      if (tocLink) {
        if (entry.isIntersecting) {
          // Remove active class from all links
          document.querySelectorAll('.toc-link').forEach(link => {
            link.classList.remove('active');
          });
          // Add active class to current link
          tocLink.classList.add('active');
        }
      }
    });
  }, observerOptions);

  // Observe all headings
  headings.forEach(heading => {
    observer.observe(heading);
  });

  // Smooth scroll for TOC links
  document.querySelectorAll('.toc-link').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        const offsetTop = target.offsetTop - 100;
        window.scrollTo({
          top: offsetTop,
          behavior: 'smooth'
        });

        // Close mobile TOC after clicking
        const sidebar = document.querySelector('.doc-sidebar');
        if (sidebar && window.innerWidth < 1024) {
          sidebar.classList.remove('mobile-open');
        }
      }
    });
  });
});
</script>

      </aside>

      <!-- Main Content -->
      <div class="doc-main">
        <div class="doc-card">
          
          <h1>HMI NuGet Package Usage</h1>
          

          
          <p class="doc-meta">Integrate video playback controls into your TwinCAT HMI and WPF applications</p>
          

          <!-- PDF Download Button -->
          
          

          
          <div class="doc-download-section">
            <a href="/EventVideoPlayback/assets/pdf/hmi-usage.pdf" class="btn-download-pdf" download>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              Download as PDF
            </a>
            <a href="/EventVideoPlayback/assets/pdf/complete-documentation.pdf" class="btn-download-pdf btn-download-complete" download>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="12" y1="18" x2="12" y2="12"></line>
                <line x1="9" y1="15" x2="15" y2="15"></line>
              </svg>
              Download Complete Docs
            </a>
          </div>
          

          <div class="doc-content">
            <h2 id="overview">Overview</h2>

<p>The Event Video Playback HMI NuGet package provides ready-to-use WPF controls for displaying and controlling video playback in your HMI applications. This guide covers installation, configuration, and usage.</p>

<h2 id="installation">Installation</h2>

<h3 id="prerequisites">Prerequisites</h3>

<ul>
  <li><strong>Visual Studio 2019 or later</strong></li>
  <li><strong>TwinCAT HMI Framework</strong> (for HMI projects) or standalone <strong>WPF application</strong></li>
  <li><strong>.NET 8 Framework</strong></li>
  <li><strong>NuGet Package Manager</strong></li>
</ul>

<h3 id="install-via-nuget">Install via NuGet</h3>

<h4 id="option-1-package-manager-console">Option 1: Package Manager Console</h4>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Install-Package</span><span class="w"> </span><span class="nx">EventVideoPlayback.HMI</span><span class="w">
</span></code></pre></div></div>

<h4 id="option-2-nuget-package-manager-ui">Option 2: NuGet Package Manager UI</h4>

<ol>
  <li>Right-click on your project in Solution Explorer</li>
  <li>Select <strong>Manage NuGet Packages</strong></li>
  <li>Click on <strong>Browse</strong> tab</li>
  <li>Search for ‚ÄúEventVideoPlayback.HMI‚Äù</li>
  <li>Click <strong>Install</strong></li>
</ol>

<h4 id="option-3-beckhoff-usa-community-package-feed">Option 3: Beckhoff USA Community Package Feed</h4>

<p>Add the Beckhoff USA Community package feed to your NuGet sources:</p>

<ol>
  <li><strong>Tools</strong> &gt; <strong>Options</strong> &gt; <strong>NuGet Package Manager</strong> &gt; <strong>Package Sources</strong></li>
  <li>Click the <strong>+</strong> button</li>
  <li>Name: <code class="language-plaintext highlighter-rouge">Beckhoff USA Community</code></li>
  <li>Source: <code class="language-plaintext highlighter-rouge">https://packages.beckhoff-usa-community.com/nuget/v3/index.json</code></li>
  <li>Click <strong>OK</strong></li>
</ol>

<p>Then search for and install the package.</p>

<h2 id="video-player-control">Video Player Control</h2>

<h3 id="basic-usage">Basic Usage</h3>

<p>Add the video player control to your XAML:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"YourNamespace.MainWindow"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:evp=</span><span class="s">"clr-namespace:EventVideoPlayback.HMI.Controls;assembly=EventVideoPlayback.HMI"</span>
        <span class="na">Title=</span><span class="s">"Event Video Playback"</span> <span class="na">Height=</span><span class="s">"600"</span> <span class="na">Width=</span><span class="s">"800"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;Grid&gt;</span>
        <span class="nt">&lt;evp:EventVideoPlayer</span> <span class="na">x:Name=</span><span class="s">"videoPlayer"</span>
                              <span class="na">VideoSource=</span><span class="s">"{Binding CurrentVideoPath}"</span>
                              <span class="na">AutoPlay=</span><span class="s">"True"</span>
                              <span class="na">ShowControls=</span><span class="s">"True"</span>
                              <span class="na">Volume=</span><span class="s">"0.5"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</code></pre></div></div>

<h3 id="control-properties">Control Properties</h3>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Type</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">VideoSource</code></td>
      <td>string</td>
      <td>null</td>
      <td>Path to the video file to play</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">AutoPlay</code></td>
      <td>bool</td>
      <td>false</td>
      <td>Automatically start playback when source is set</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ShowControls</code></td>
      <td>bool</td>
      <td>true</td>
      <td>Display playback controls</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Volume</code></td>
      <td>double</td>
      <td>0.5</td>
      <td>Volume level (0.0 to 1.0)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">IsMuted</code></td>
      <td>bool</td>
      <td>false</td>
      <td>Mute audio</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Loop</code></td>
      <td>bool</td>
      <td>false</td>
      <td>Loop video playback</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Stretch</code></td>
      <td>Stretch</td>
      <td>Uniform</td>
      <td>How video is stretched to fill control</td>
    </tr>
  </tbody>
</table>

<h3 id="control-methods">Control Methods</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Play the video</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="nf">Play</span><span class="p">();</span>

<span class="c1">// Pause the video</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="nf">Pause</span><span class="p">();</span>

<span class="c1">// Stop the video</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="nf">Stop</span><span class="p">();</span>

<span class="c1">// Seek to specific position (in seconds)</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="nf">Seek</span><span class="p">(</span><span class="m">10.5</span><span class="p">);</span>

<span class="c1">// Load a new video</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="nf">LoadVideo</span><span class="p">(</span><span class="s">"C:\\Videos\\MachineEvent_001.mp4"</span><span class="p">);</span>

<span class="c1">// Take a snapshot</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="nf">SaveSnapshot</span><span class="p">(</span><span class="s">"C:\\Snapshots\\snapshot.png"</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="events">Events</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Video loaded and ready to play</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="n">VideoLoaded</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Video loaded: </span><span class="p">{</span><span class="n">e</span><span class="p">.</span><span class="n">VideoPath</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// Playback started</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="n">PlaybackStarted</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Playback started"</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// Playback paused</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="n">PlaybackPaused</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Playback paused"</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// Playback completed</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="n">PlaybackCompleted</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">Debug</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Playback completed"</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// Error occurred</span>
<span class="n">videoPlayer</span><span class="p">.</span><span class="n">ErrorOccurred</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Error: </span><span class="p">{</span><span class="n">e</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">}</span><span class="s">"</span><span class="p">,</span> <span class="s">"Video Error"</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="complete-example-application">Complete Example Application</h2>

<h3 id="xaml-mainwindowxaml">XAML (MainWindow.xaml)</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"VideoPlaybackDemo.MainWindow"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:evp=</span><span class="s">"clr-namespace:EventVideoPlayback.HMI.Controls;assembly=EventVideoPlayback.HMI"</span>
        <span class="na">Title=</span><span class="s">"Event Video Playback Demo"</span>
        <span class="na">Height=</span><span class="s">"700"</span> <span class="na">Width=</span><span class="s">"1000"</span>
        <span class="na">Loaded=</span><span class="s">"Window_Loaded"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;Grid</span> <span class="na">Background=</span><span class="s">"#1a1a1a"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Grid.RowDefinitions&gt;</span>
            <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"*"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Grid.RowDefinitions&gt;</span>

        <span class="c">&lt;!-- Header --&gt;</span>
        <span class="nt">&lt;Border</span> <span class="na">Grid.Row=</span><span class="s">"0"</span> <span class="na">Background=</span><span class="s">"#D32F2F"</span> <span class="na">Padding=</span><span class="s">"15"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">"Event Video Playback Viewer"</span>
                       <span class="na">FontSize=</span><span class="s">"24"</span>
                       <span class="na">FontWeight=</span><span class="s">"Bold"</span>
                       <span class="na">Foreground=</span><span class="s">"White"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Border&gt;</span>

        <span class="c">&lt;!-- Video Player --&gt;</span>
        <span class="nt">&lt;evp:EventVideoPlayer</span> <span class="na">Grid.Row=</span><span class="s">"1"</span>
                              <span class="na">x:Name=</span><span class="s">"videoPlayer"</span>
                              <span class="na">Margin=</span><span class="s">"10"</span>
                              <span class="na">ShowControls=</span><span class="s">"True"</span>
                              <span class="na">Volume=</span><span class="s">"0.7"</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- Video List and Controls --&gt;</span>
        <span class="nt">&lt;Grid</span> <span class="na">Grid.Row=</span><span class="s">"2"</span> <span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
                <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">"*"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">"Auto"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>

            <span class="c">&lt;!-- Video List --&gt;</span>
            <span class="nt">&lt;ListBox</span> <span class="na">Grid.Column=</span><span class="s">"0"</span>
                     <span class="na">x:Name=</span><span class="s">"videoListBox"</span>
                     <span class="na">SelectionChanged=</span><span class="s">"VideoListBox_SelectionChanged"</span>
                     <span class="na">Background=</span><span class="s">"#2a2a2a"</span>
                     <span class="na">Foreground=</span><span class="s">"White"</span>
                     <span class="na">Padding=</span><span class="s">"5"</span>
                     <span class="na">Height=</span><span class="s">"150"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;ListBox.ItemTemplate&gt;</span>
                    <span class="nt">&lt;DataTemplate&gt;</span>
                        <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">"üìπ"</span> <span class="na">Margin=</span><span class="s">"0,0,10,0"</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;TextBlock</span> <span class="na">Text=</span><span class="s">"{Binding Name}"</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/StackPanel&gt;</span>
                    <span class="nt">&lt;/DataTemplate&gt;</span>
                <span class="nt">&lt;/ListBox.ItemTemplate&gt;</span>
            <span class="nt">&lt;/ListBox&gt;</span>

            <span class="c">&lt;!-- Control Buttons --&gt;</span>
            <span class="nt">&lt;StackPanel</span> <span class="na">Grid.Column=</span><span class="s">"1"</span> <span class="na">Margin=</span><span class="s">"10,0,0,0"</span> <span class="na">VerticalAlignment=</span><span class="s">"Center"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">"Refresh List"</span>
                        <span class="na">Click=</span><span class="s">"RefreshList_Click"</span>
                        <span class="na">Padding=</span><span class="s">"15,5"</span>
                        <span class="na">Margin=</span><span class="s">"0,0,0,5"</span>
                        <span class="na">Background=</span><span class="s">"#D32F2F"</span>
                        <span class="na">Foreground=</span><span class="s">"White"</span>
                        <span class="na">BorderThickness=</span><span class="s">"0"</span>
                        <span class="na">Cursor=</span><span class="s">"Hand"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">"Open Folder"</span>
                        <span class="na">Click=</span><span class="s">"OpenFolder_Click"</span>
                        <span class="na">Padding=</span><span class="s">"15,5"</span>
                        <span class="na">Margin=</span><span class="s">"0,0,0,5"</span>
                        <span class="na">Background=</span><span class="s">"#424242"</span>
                        <span class="na">Foreground=</span><span class="s">"White"</span>
                        <span class="na">BorderThickness=</span><span class="s">"0"</span>
                        <span class="na">Cursor=</span><span class="s">"Hand"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">"Take Snapshot"</span>
                        <span class="na">Click=</span><span class="s">"TakeSnapshot_Click"</span>
                        <span class="na">Padding=</span><span class="s">"15,5"</span>
                        <span class="na">Background=</span><span class="s">"#424242"</span>
                        <span class="na">Foreground=</span><span class="s">"White"</span>
                        <span class="na">BorderThickness=</span><span class="s">"0"</span>
                        <span class="na">Cursor=</span><span class="s">"Hand"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/StackPanel&gt;</span>
        <span class="nt">&lt;/Grid&gt;</span>
    <span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</code></pre></div></div>

<h3 id="code-behind-mainwindowxamlcs">Code-Behind (MainWindow.xaml.cs)</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">EventVideoPlayback.HMI.Controls</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">VideoPlaybackDemo</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">MainWindow</span> <span class="p">:</span> <span class="n">Window</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">string</span> <span class="n">VIDEO_FOLDER</span> <span class="p">=</span> <span class="s">@"C:\TwinCAT\EventVideoPlayback\Videos"</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">MainWindow</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">InitializeComponent</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">Window_Loaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Subscribe to video player events</span>
            <span class="n">videoPlayer</span><span class="p">.</span><span class="n">VideoLoaded</span> <span class="p">+=</span> <span class="n">VideoPlayer_VideoLoaded</span><span class="p">;</span>
            <span class="n">videoPlayer</span><span class="p">.</span><span class="n">ErrorOccurred</span> <span class="p">+=</span> <span class="n">VideoPlayer_ErrorOccurred</span><span class="p">;</span>
            <span class="n">videoPlayer</span><span class="p">.</span><span class="n">PlaybackCompleted</span> <span class="p">+=</span> <span class="n">VideoPlayer_PlaybackCompleted</span><span class="p">;</span>

            <span class="c1">// Load initial video list</span>
            <span class="nf">RefreshVideoList</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">RefreshVideoList</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">VIDEO_FOLDER</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Video folder not found: </span><span class="p">{</span><span class="n">VIDEO_FOLDER</span><span class="p">}</span><span class="s">"</span><span class="p">,</span>
                                    <span class="s">"Error"</span><span class="p">,</span>
                                    <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                                    <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Error</span><span class="p">);</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="kt">var</span> <span class="n">videoFiles</span> <span class="p">=</span> <span class="n">Directory</span><span class="p">.</span><span class="nf">GetFiles</span><span class="p">(</span><span class="n">VIDEO_FOLDER</span><span class="p">,</span> <span class="s">"*.mp4"</span><span class="p">)</span>
                                          <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">f</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FileInfo</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
                                          <span class="p">.</span><span class="nf">OrderByDescending</span><span class="p">(</span><span class="n">f</span> <span class="p">=&gt;</span> <span class="n">f</span><span class="p">.</span><span class="n">CreationTime</span><span class="p">)</span>
                                          <span class="p">.</span><span class="nf">ToList</span><span class="p">();</span>

                <span class="n">videoListBox</span><span class="p">.</span><span class="n">ItemsSource</span> <span class="p">=</span> <span class="n">videoFiles</span><span class="p">;</span>

                <span class="c1">// Auto-select first video</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">videoFiles</span><span class="p">.</span><span class="nf">Any</span><span class="p">())</span>
                <span class="p">{</span>
                    <span class="n">videoListBox</span><span class="p">.</span><span class="n">SelectedIndex</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Error loading video list: </span><span class="p">{</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">}</span><span class="s">"</span><span class="p">,</span>
                                <span class="s">"Error"</span><span class="p">,</span>
                                <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                                <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Error</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">VideoListBox_SelectionChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Controls</span><span class="p">.</span><span class="n">SelectionChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">videoListBox</span><span class="p">.</span><span class="n">SelectedItem</span> <span class="k">is</span> <span class="n">FileInfo</span> <span class="n">fileInfo</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">videoPlayer</span><span class="p">.</span><span class="nf">LoadVideo</span><span class="p">(</span><span class="n">fileInfo</span><span class="p">.</span><span class="n">FullName</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">RefreshList_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">RefreshVideoList</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">OpenFolder_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">VIDEO_FOLDER</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="n">Process</span><span class="p">.</span><span class="nf">Start</span><span class="p">(</span><span class="s">"explorer.exe"</span><span class="p">,</span> <span class="n">VIDEO_FOLDER</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Folder not found: </span><span class="p">{</span><span class="n">VIDEO_FOLDER</span><span class="p">}</span><span class="s">"</span><span class="p">,</span>
                                    <span class="s">"Error"</span><span class="p">,</span>
                                    <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                                    <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Warning</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Error opening folder: </span><span class="p">{</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">}</span><span class="s">"</span><span class="p">,</span>
                                <span class="s">"Error"</span><span class="p">,</span>
                                <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                                <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Error</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">TakeSnapshot_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">snapshotPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span>
                    <span class="n">VIDEO_FOLDER</span><span class="p">,</span>
                    <span class="s">$"Snapshot_</span><span class="p">{</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">:</span><span class="n">yyyyMMdd_HHmmss</span><span class="p">}</span><span class="s">.png"</span>
                <span class="p">);</span>

                <span class="n">videoPlayer</span><span class="p">.</span><span class="nf">SaveSnapshot</span><span class="p">(</span><span class="n">snapshotPath</span><span class="p">);</span>

                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Snapshot saved to:\n</span><span class="p">{</span><span class="n">snapshotPath</span><span class="p">}</span><span class="s">"</span><span class="p">,</span>
                                <span class="s">"Snapshot Saved"</span><span class="p">,</span>
                                <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                                <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Information</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Error saving snapshot: </span><span class="p">{</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">}</span><span class="s">"</span><span class="p">,</span>
                                <span class="s">"Error"</span><span class="p">,</span>
                                <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                                <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Error</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">VideoPlayer_VideoLoaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">VideoLoadedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Optional: Update UI when video loads</span>
            <span class="n">Title</span> <span class="p">=</span> <span class="s">$"Event Video Playback - </span><span class="p">{</span><span class="n">Path</span><span class="p">.</span><span class="nf">GetFileName</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">VideoPath</span><span class="p">)}</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">VideoPlayer_ErrorOccurred</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">VideoErrorEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="s">$"Video playback error:\n</span><span class="p">{</span><span class="n">e</span><span class="p">.</span><span class="n">ErrorMessage</span><span class="p">}</span><span class="s">"</span><span class="p">,</span>
                            <span class="s">"Playback Error"</span><span class="p">,</span>
                            <span class="n">MessageBoxButton</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                            <span class="n">MessageBoxImage</span><span class="p">.</span><span class="n">Error</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">VideoPlayer_PlaybackCompleted</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Optional: Auto-play next video</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">videoListBox</span><span class="p">.</span><span class="n">SelectedIndex</span> <span class="p">&lt;</span> <span class="n">videoListBox</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="n">Count</span> <span class="p">-</span> <span class="m">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">videoListBox</span><span class="p">.</span><span class="n">SelectedIndex</span><span class="p">++;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="integration-with-twincat-hmi">Integration with TwinCAT HMI</h2>

<p>For TwinCAT HMI projects, the control can be integrated with symbol bindings:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;evp:EventVideoPlayer</span> <span class="na">VideoSource=</span><span class="s">"{Binding PLC.VideoPath, Mode=OneWay}"</span>
                      <span class="na">AutoPlay=</span><span class="s">"{Binding PLC.AutoPlayEnabled, Mode=OneWay}"</span>
                      <span class="na">Volume=</span><span class="s">"{Binding HMI.VolumeLevel, Mode=TwoWay}"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<h2 id="styling-and-customization">Styling and Customization</h2>

<h3 id="custom-control-template">Custom Control Template</h3>

<p>You can customize the appearance of the video player:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;evp:EventVideoPlayer</span> <span class="na">x:Name=</span><span class="s">"videoPlayer"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;evp:EventVideoPlayer.Style&gt;</span>
        <span class="nt">&lt;Style</span> <span class="na">TargetType=</span><span class="s">"evp:EventVideoPlayer"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Background"</span> <span class="na">Value=</span><span class="s">"#1a1a1a"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Foreground"</span> <span class="na">Value=</span><span class="s">"White"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"BorderBrush"</span> <span class="na">Value=</span><span class="s">"#D32F2F"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"BorderThickness"</span> <span class="na">Value=</span><span class="s">"2"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Style&gt;</span>
    <span class="nt">&lt;/evp:EventVideoPlayer.Style&gt;</span>
<span class="nt">&lt;/evp:EventVideoPlayer&gt;</span>
</code></pre></div></div>

<h2 id="performance-tips">Performance Tips</h2>

<ol>
  <li><strong>Preload Videos</strong>: Load videos in background threads to avoid UI freezing</li>
  <li><strong>Hardware Acceleration</strong>: Ensure GPU acceleration is enabled</li>
  <li><strong>File Formats</strong>: Use H.264 (avc1) codec for best compatibility</li>
  <li><strong>Resolution</strong>: Match video resolution to display size</li>
  <li><strong>Memory Management</strong>: Dispose of video player when not in use</li>
</ol>

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="video-wont-play">Video Won‚Äôt Play</h3>

<ul>
  <li>Verify the video file exists and is accessible</li>
  <li>Check that the codec is supported (H.264 recommended)</li>
  <li>Ensure .NET 8 runtime is installed</li>
  <li>Try playing the video in Windows Media Player to verify it‚Äôs valid</li>
</ul>

<h3 id="control-not-visible">Control Not Visible</h3>

<ul>
  <li>Check that the NuGet package is correctly installed</li>
  <li>Verify XAML namespace declaration</li>
  <li>Ensure the control has proper Width/Height or is in a sized container</li>
</ul>

<h3 id="performance-issues">Performance Issues</h3>

<ul>
  <li>Reduce video resolution</li>
  <li>Use hardware acceleration</li>
  <li>Close other resource-intensive applications</li>
  <li>Check CPU and GPU usage</li>
</ul>

<h2 id="best-practices">Best Practices</h2>

<ol>
  <li><strong>Error Handling</strong>: Always subscribe to ErrorOccurred event</li>
  <li><strong>Resource Cleanup</strong>: Dispose of video player when closing window</li>
  <li><strong>File Validation</strong>: Verify video files exist before loading</li>
  <li><strong>User Feedback</strong>: Show loading indicators for long operations</li>
  <li><strong>Testing</strong>: Test with various video formats and resolutions</li>
</ol>

<h2 id="next-steps">Next Steps</h2>

<ul>
  <li>Review <a href="/EventVideoPlayback/docs/plc-usage/">PLC Library Usage</a> to trigger video recordings</li>
  <li>Configure <a href="/EventVideoPlayback/docs/service-config/">Service Settings</a> for optimal performance</li>
  <li>Check <a href="/EventVideoPlayback/docs/getting-started/">Getting Started</a> for installation help</li>
</ul>

          </div>

          <hr style="margin-top: 4rem; margin-bottom: 2rem;">

          <div style="text-align: center;">
            <a href="/EventVideoPlayback/" class="btn btn-primary">‚Üê Back to Home</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Mobile TOC toggle
document.addEventListener('DOMContentLoaded', function() {
  const toggle = document.getElementById('mobile-toc-toggle');
  const sidebar = document.getElementById('doc-sidebar');

  if (toggle && sidebar) {
    toggle.addEventListener('click', function() {
      sidebar.classList.toggle('mobile-open');
      toggle.classList.toggle('open');
    });

    // Close sidebar when clicking outside
    document.addEventListener('click', function(e) {
      if (window.innerWidth < 1024) {
        if (!sidebar.contains(e.target) && !toggle.contains(e.target)) {
          sidebar.classList.remove('mobile-open');
          toggle.classList.remove('open');
        }
      }
    });
  }
});
</script>


  </main>

  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Event Video Playback</h3>
        <p>Transform TwinCAT Vision images into event-driven video recordings for industrial automation.</p>
      </div>

      <div class="footer-section">
        <h3>Documentation</h3>
        <ul>
          <li><a href="/EventVideoPlayback/docs/getting-started/">Getting Started</a></li>
          <li><a href="/EventVideoPlayback/docs/plc-usage/">PLC Library Usage</a></li>
          <li><a href="/EventVideoPlayback/docs/service-config/">Service Configuration</a></li>
          <li><a href="/EventVideoPlayback/docs/hmi-usage/">HMI User Control</a></li>
        </ul>
      </div>

      <div class="footer-section">
        <h3>Resources</h3>
        <ul>
          <li><a href="https://github.com/Beckhoff-USA-Community/EventVideoPlayback" target="_blank">GitHub Repository</a></li>
          <li><a href="https://packages.beckhoff-usa-community.com/" target="_blank">Package Feed</a></li>
          <li><a href="https://github.com/Beckhoff-USA-Community/EventVideoPlayback/issues" target="_blank">Report Issues</a></li>
          <li><a href="https://github.com/Beckhoff-USA-Community" target="_blank">Beckhoff USA Community</a></li>
        </ul>
      </div>

      <div class="footer-section">
        <h3>Community</h3>
        <ul>
          <li><a href="https://github.com/Beckhoff-USA-Community" target="_blank">Beckhoff USA Community</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 Beckhoff USA Community | Licensed under MIT License</p>
    </div>
  </div>
</footer>


  <script src="/EventVideoPlayback/assets/js/main.js"></script>
</body>
</html>
